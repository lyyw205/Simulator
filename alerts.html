<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=414, initial-scale=1, viewport-fit=cover" />
  <title>ì•Œë¦¼</title>
  <link rel="stylesheet" href="assets/app.css" />
  <style>
      .tag{font-size:11px; 
        color:#5f5f5f; 
        padding:4px 4px 4px 0;
        display: flex;
        justify-content: space-between;
        width: 100%; 
      }
      .time {
        font-size: 14px;
        font-weight: 400;
        color: #8f8f8f;
      }
      .category {
        font-size: 14px;
        font-weight: 600;
        color: #8f8f8f;
      }
      .alert-msg {
        font-size: 16px;
        font-weight: 500;
      }
  </style>
</head>
<body>
  <div class="page-wrapper">
    <main class="main-content">
      <h2 class="page-title" >ì•Œë¦¼</h2>
      <div class="alert-section">
        <div class="card">
          <div class="tag">
            <span class="category">ğŸ“¢ ì•Œë¦¼</span>
            <span class="time">12:30</span>
          </div>
          <div>
            <span class="alert-msg">í˜¸ê°ì„ 3ê°œ ë°›ì•˜ì–´ìš” ğŸ‰</span>
          </div>
        </div>
        <div class="card">
          <div class="tag">
            <span class="category">ğŸ“¢ ì•Œë¦¼</span>
            <span class="time">12:30</span>
          </div>
          <div>
            <span class="alert-msg">í˜¸ê°ì„ 3ê°œ ë°›ì•˜ì–´ìš” ğŸ‰</span>
          </div>
        </div>
      </div>
      <section class="card">
        <div class="list" id="alertList"></div>
        <p class="muted mini" id="noAlertMsg">ì•„ì§ ì•Œë¦¼ì´ ì—†ì–´ìš”.</p>
      </section>
    </main>
  </div>
  <script src="assets/app.js"></script>
  <script>
    App.ensureDefaults();
    App.renderNav('alerts');

    (function(){
      const me = App.lsGet(App.KEY.me); 
      if(!me){ location.href='login.html'; return; }

          // === ì¹´í…Œê³ ë¦¬ ë§¤í•‘ (ë¼ë²¨/í´ë˜ìŠ¤) ===
      const CATS = {
        notice: { label: 'ğŸ“¢ ê³µì§€',   cls: 'cat-notice' },
        like:   { label: 'ğŸ“¢ í˜¸ê°',   cls: 'cat-like' },
        match:  { label: 'ğŸ“¢ ë§¤ì¹­',   cls: 'cat-match' },
        system: { label: 'ğŸ“¢ ì‹œìŠ¤í…œ', cls: 'cat-system' },
        default:{ label: 'ğŸ“¢ ì•Œë¦¼',   cls: 'cat-default' }
      };

      // === ìƒ˜í”Œ ì•Œë¦¼ ì‹œë“œ: ê¸°ì¡´ ì•Œë¦¼ì´ ì—†ì„ ë•Œë§Œ ì£¼ì… ===
      const existing = App.lsGet(App.KEY.alerts, []);
      if (!existing || existing.length === 0) {
        const now = Date.now();
        const samples = [
          { msg: 'í˜¸ê°ì„ 3ê°œ ë°›ì•˜ì–´ìš” ğŸ‰', at: now - 1000 * 60 * 5 },
          { msg: '13ì‹œ 50ë¶„ë¶€í„° ë¡œí…Œì´ì…˜ ì†Œê°œíŒ…ì´ 6ì¸µì—ì„œ ì§„í–‰ë©ë‹ˆë‹¤. <br> ì„ ì°©ìˆœ ë§ˆê°ë˜ë¯€ë¡œ ì°¸ê°€ë¥¼ ì›í•˜ì‹œë©´ ë¯¸ë¦¬ ë„ì°© ë¶€íƒë“œë¦½ë‹ˆë‹¤.', at: now - 1000 * 60 * 60 },
          { msg: 'ì„œë¡œì˜ í˜¸ê°ì´ í†µí–ˆì–´ìš”!', at: now - 1000 * 60 * 60 * 24 }
        ];
        App.lsSet(App.KEY.alerts, samples); // â† ì—¬ê¸°ì„œ samplesë¥¼ ì €ì¥
      }
      // ================================================

      function render(){
        const list = document.getElementById('alertList');
        const alerts = App.lsGet(App.KEY.alerts, []).sort((a,b)=>b.at-a.at);
        list.innerHTML='';
        if(alerts.length===0){ 
          document.getElementById('noAlertMsg').style.display='block'; 
          return; 
        }
        document.getElementById('noAlertMsg').style.display='none';
        alerts.forEach(a=>{
          const cat = CATS[a.cat] || CATS.default;
          const timeText = new Date(a.at).toLocaleTimeString('ko-KR', {
            hour: '2-digit',
            minute: '2-digit',
            hour12: false
          });
          const div = document.createElement('div');
          div.className='li';
          div.innerHTML = `<div class="tag"><span class="category">${cat.label}</span>
      <span class="time">${timeText}</span></div>
      <div><span class="alerts-msg">${a.msg}</span></div>
    `;
          list.appendChild(div);
        });
      }
      render();
    })();
  </script>
</body>
</html>
